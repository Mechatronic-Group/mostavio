---
import { Image } from "astro:assets";

import Button from "./atoms/Button.astro";
import Headline from "./atoms/Headline.astro";
import Container from "./molecules/Container.astro";

import smokeSplit1 from "../assets/evtol_img/design4.png";
import smokeSplit2 from "../assets/evtol_img/design5.png";
import smokeSplit3 from "../assets/evtol_img/design6.png";
import ModelPlaceholder from "../assets/v2/home/Model_Placeholder.png";

export interface ModelData {
    name: string;
    tagline: string;
    content: string;
    preview: any;
}

export interface ModelsCarouselProps {
    aircrafts?: ModelData[];
    uniqueId?: string;
    containerClass?: string;
    slideClass?: string;
    imageClass?: string;
    showContent?: boolean;
}

// Default aircrafts data
const defaultModels: ModelData[] = [
    {
        name: "The MX1",
        tagline: "Urban Mobility, Elevated",
        content:
            "MX1 is a next-generation 2-3 passenger eVTOL aircraft designed to transform city travel. Equipped with AI navigation, real-time collision avoidance, and layered safety systems.",
        preview: ModelPlaceholder,
    },
    {
        name: "AeroGuardian",
        tagline: "Built for Urgency",
        content:
            "Designed for versatility in urgent care and medevac operations, AeroGuardian brings advanced mobility to where it matters most.",
        preview: ModelPlaceholder,
    },
    {
        name: "Ultralight",
        tagline: "Freedom Takes Flight",
        content:
            "The Ultralight is a one-passenger eVTOL crafted for personal recreation. It's ideal for rural flight with no license required.",
        preview: ModelPlaceholder,
    },
];

const defaultSlideClasses =
    "bg-gradient-painted swiper-slide relative mr-0 backdrop-blur-2xl";

const {
    aircrafts = defaultModels,
    containerClass = "aircrafts-container",
    slideClass = defaultSlideClasses,
    imageClass = "object-contain w-full h-96 md:h-[85vh]",
    showContent = true,
} = Astro.props as ModelsCarouselProps;
---

<section class="relative">
    <Container>
        <Headline className="uppercase my-10" headline="Aircrafts" />
        <div class={`swiper container ${containerClass}`}>
            <div class="swiper-wrapper">
                {
                    aircrafts.map((model, index) => (
                        <div class={slideClass}>
                            <div class="relative h-full">
                                <div class="relative">
                                    <Image
                                        class={imageClass}
                                        src={model.preview}
                                        alt={`${model.name} - ${model.tagline}`}
                                        loading="lazy"
                                    />
                                </div>

                                {showContent && (
                                    <>
                                        <div class="relative md:absolute top-4 ease-in-out left-0 z-10 max-w-xs">
                                            <div class="backdrop-blur-sm text-white">
                                                <p class="text-sm leading-relaxed">
                                                    {model.content}
                                                </p>
                                            </div>
                                            <Button
                                                link="/aircrafts"
                                                ctaLabel="Learn More"
                                                containerClass="justify-start ml-2 mb-15 md:mb-20"
                                                variant="transparent"
                                            />
                                        </div>

                                        <div class="absolute top-4 ease-in-out right-0 z-10 text-right">
                                            <div class="space-y-4  backdrop-blur-sm text-white">
                                                <p class="uppercase font-medium">
                                                    {model.tagline}
                                                </p>
                                                <h3 class="uppercase text-5xl font-bold mb-1">
                                                    {model.name}
                                                </h3>
                                            </div>
                                        </div>
                                    </>
                                )}
                            </div>
                        </div>
                    ))
                }
            </div>

            <div class="swiper-pagination mt-6"></div>

            <div class="swiper-button swiper-button-prev"></div>
            <div class="swiper-button swiper-button-next"></div>

            <div class="swiper-scrollbar"></div>
        </div>
    </Container>
</section>

<script>
    import Swiper from "swiper";
    import { Navigation, Pagination, Mousewheel } from "swiper/modules";
    import "swiper/css/bundle";

    const swiperConfig = {
        modules: [Navigation, Pagination, Mousewheel],
        loop: true,
        spaceBetween: 30,
        slidesPerView: 1,
        // mousewheel: {
        //     thresholdDelta: 50,
        //     thresholdTime: 300,
        //     sensitivity: 1,
        //     releaseOnEdges: true,
        //     forceToAxis: true,
        // },
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
        },
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        autoplay: {
            delay: 5000,
            disableOnInteraction: false,
        },
    };

    const swiper = new Swiper(".swiper", swiperConfig);
</script>

<style is:global>
    .swiper.aircrafts-container {
        margin: 0;
    }
    .swiper-button-next:hover,
    .swiper-button-prev:hover {
        transform: scale(1.1);
    }

    .swiper-pagination-bullet {
        background: #6b7280;
        opacity: 0.5;
        width: 12px;
        height: 12px;
        margin: 0 6px;
        transition: all 0.2s ease;
    }

    .swiper-pagination-bullet-active {
        background: var(--swiper-pagination-color, rgb(215, 119, 22));
        opacity: 1;
        transform: scale(1.2);
    }

    .swiper-pagination {
        position: relative;
        margin-top: 20px;
    }

    /* Dark mode adjustments */
    @media (prefers-color-scheme: dark) {
        .swiper-button-next,
        .swiper-button-prev {
            background: rgba(0, 0, 0, 0.8);
            color: var(--swiper-theme-color, rgb(215, 119, 22));
        }

        .swiper-button-next:hover,
        .swiper-button-prev:hover {
            background: rgba(0, 0, 0, 0.9);
        }

        .swiper-pagination-bullet-active {
            background: var(--swiper-theme-color, rgb(215, 119, 22));
        }
    }
</style>
