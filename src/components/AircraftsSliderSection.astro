---
import { Image } from "astro:assets";

import Button from "./atoms/Button.astro";
import Headline from "./atoms/Headline.astro";
import Container from "./molecules/Container.astro";
import ModelViewer from "./molecules/ModelViewer.astro";

// Assets
import ModelPlaceholder from "../assets/v2/home/Model_Placeholder.png";
import MuseWinner from "../assets/v2/timeline/muse_winner.png";
import GoAreoLogo from "../assets/v2/timeline/goaeroLogo.png";
import RedDotLogo from "../assets/v2/timeline/RedDot.png";
import goAeroAward from "../assets/v2/home/goAEROaward.png";

// import EvtolModel from "../assets/EvtolModel.glb";
import MX1ModelCompressed from "../assets/EvtolModelCompressed.glb";

export interface ModelData {
    name: string;
    tagline: string;
    content: string;
    preview?: any;
    glbSrc?: any;
    awards?: {
        logo: any;
        name: string;
        link: string;
    }[];
}

export interface ModelsCarouselProps {
    aircrafts?: ModelData[];
    uniqueId?: string;
    containerClass?: string;
    slideClass?: string;
    imageClass?: string;
    showContent?: boolean;
}

// Default aircrafts data
const defaultModels: ModelData[] = [
    {
        name: "The MX1",
        tagline: "Urban Mobility, Elevated",
        content:
            "MX1 is a next-generation 2-3 passenger eVTOL aircraft designed to transform city travel. Equipped with AI navigation, real-time collision avoidance, and layered safety systems.",
        // preview: ModelPlaceholder,
        glbSrc: MX1ModelCompressed,
        awards: [
            {
                logo: MuseWinner,
                name: "Muse Design Award",
                link: "/news/mostavio-wins-muse-design-award",
            },
            {
                logo: RedDotLogo,
                name: "Red Dot Award",
                link: "/news/mostavio-wins-red-dot-award",
            },
        ],
    },
    {
        name: "AeroGuardian",
        tagline: "Built for Urgency",
        content:
            "Designed for versatility in urgent care and medevac operations, AeroGuardian brings advanced mobility to where it matters most.",
        // preview: ModelPlaceholder,
        glbSrc: MX1ModelCompressed,
        awards: [
            {
                logo: goAeroAward,
                name: "GOAERO Stage 1 Winner",
                link: "/news/mostavio-wins-goaero-stage-1",
            },
        ],
    },
    {
        name: "Ultralight",
        tagline: "Freedom Takes Flight",
        content:
            "The Ultralight is a one-passenger eVTOL crafted for personal recreation. It's ideal for rural flight with no license required.",
        preview: ModelPlaceholder,
        // glbSrc: EvtolModel,
    },
];

const defaultSlideClasses = "swiper-slide relative mr-0 backdrop-blur-2xl";

const {
    aircrafts = defaultModels,
    containerClass = "aircrafts-container",
    slideClass = defaultSlideClasses,
    imageClass = "object-contain w-full h-96 md:h-[85vh]",
    showContent = true,
} = Astro.props as ModelsCarouselProps;
---

<section class="relative mt-48 md:mt-96 scroll-mt-24">
    <Container>
        <div class={`swiper container ${containerClass}`}>
            <div class="swiper-wrapper">
                {
                    aircrafts.map((model, index) => (
                        <div class={slideClass}>
                            <div class="relative h-full">
                                {showContent && (
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-16 mb-8 p-4">
                                        <div class="text-left">
                                            <div class="backdrop-blur-sm text-white space-y-4">
                                                <p class="uppercase font-medium text-lg">
                                                    {model.tagline}
                                                </p>
                                                <h3 class="uppercase text-4xl md:text-5xl font-bold">
                                                    {model.name}
                                                </h3>
                                            </div>

                                            {model.awards && (
                                                <div class="flex flex-row my-12 space-x-4">
                                                    {model.awards.map(
                                                        (award) => (
                                                            <Image
                                                                class="h-16 w-auto"
                                                                src={award.logo}
                                                                alt={award.name}
                                                                loading="lazy"
                                                            />
                                                        ),
                                                    )}
                                                </div>
                                            )}
                                        </div>

                                        <div class="backdrop-blur-sm text-white text-right">
                                            <p class="text-sm leading-relaxed mb-12">
                                                {model.content}
                                            </p>
                                            <Button
                                                link="/aircrafts"
                                                ctaLabel="Learn More"
                                                containerClass="justify-end"
                                                variant="transparent"
                                            />
                                        </div>
                                    </div>
                                )}

                                <div class="relative">
                                    {model.preview && (
                                        <Image
                                            class={imageClass}
                                            src={model.preview}
                                            alt={`${model.name} - ${model.tagline}`}
                                            loading="lazy"
                                        />
                                    )}

                                    {model.glbSrc && (
                                        <ModelViewer
                                            class={imageClass}
                                            src={model.glbSrc}
                                            alt={`${model.name} - ${model.tagline}`}
                                        />
                                    )}
                                </div>
                            </div>
                        </div>
                    ))
                }
            </div>

            <div class="flex items-center justify-center space-x-4">
                <div class="swiper-button swiper-button-prev"></div>
                <div class="swiper-pagination"></div>
                <div class="swiper-button swiper-button-next"></div>
            </div>

            <!-- <div class="swiper-scrollbar"></div> -->
        </div>
    </Container>
</section>

<script>
    import Swiper from "swiper";
    import { Navigation, Pagination, Mousewheel } from "swiper/modules";
    import "swiper/css/bundle";

    const swiperConfig = {
        modules: [Navigation, Pagination],
        loop: true,
        spaceBetween: 30,
        slidesPerView: 1,
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
        },
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        autoplay: {
            delay: 5000,
            disableOnInteraction: false,
        },
    };

    const swiper = new Swiper(".swiper", swiperConfig);
</script>

<style is:global>
    .swiper.aircrafts-container {
        margin: 0;
    }
    .swiper-button-next,
    .swiper-button-prev,
    .swiper-button-prev:after,
    .swiper-button-next:after {
        color: #6b7280;
        position: relative !important;
        left: unset !important;
        right: unset !important;
        font-size: 20px !important;
    }

    .swiper-pagination-bullet {
        background-color: #fff;
        opacity: 0.5;
        width: 12px;
        height: 12px;
        margin: 0 6px;
        transition: all 0.2s ease;
    }

    .swiper-pagination-bullets.swiper-pagination-horizontal {
        width: auto !important;
    }

    .swiper-pagination-bullet-active {
        background: var(--swiper-pagination-color, rgb(215, 119, 22));
        opacity: 1;
        transform: scale(1.2);
    }

    .swiper-pagination {
        position: relative !important;
        margin-top: 5px;
        margin-bottom: 15px;
        /* margin-top: 20px; */
    }
</style>
